
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lab 7: Automatic Dependent Surveillance-Broadcast (ADS-B) &#8212; ECE447 Coruse Webpage</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'labs/Lab7';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lab 8: Digital Packet Radio – APRS" href="Lab8.html" />
    <link rel="prev" title="Lab 6: A Few Different Digital Signals" href="Lab6.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="ECE447 Coruse Webpage - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="ECE447 Coruse Webpage - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to ECE447, Communication Systems!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Course Info</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../schedule.html">Course Schedule</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Assignments and Labs</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="SkillsReview.html">Skills Review</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab1.html">Lab 1: Installing SDR Receivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab2.html">Lab 2: Capturing Signals and Displaying Signals</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab3.html">Lab 3: Scanning for Signals, Modulation, and Decimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab4.html">Lab 4: Narrowband FM</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab5.html">Lab 5: Commercial FM</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab6.html">Lab 6: A Few Different Digital Signals</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lab 7: Automatic Dependent Surveillance-Broadcast (ADS-B)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab8.html">Lab 8: Digital Packet Radio – APRS</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/usafa-ece/jupyterbook-template" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/usafa-ece/jupyterbook-template/issues/new?title=Issue%20on%20page%20%2Flabs/Lab7.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/labs/Lab7.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lab 7: Automatic Dependent Surveillance-Broadcast (ADS-B)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#decoding-adsb-packets">Decoding ADSB Packets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-report">Lab Report</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#just-for-fun">Just for Fun</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#real-time-adsb-plane-plotting">Real Time ADSB Plane PLotting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dictator-alert">Dictator Alert</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unfiltered-adsb">Unfiltered ADSB</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lab-7-automatic-dependent-surveillance-broadcast-ads-b">
<h1>Lab 7: Automatic Dependent Surveillance-Broadcast (ADS-B)<a class="headerlink" href="#lab-7-automatic-dependent-surveillance-broadcast-ads-b" title="Link to this heading">#</a></h1>
<p>(Adapted from Dr. John Pauly’s Stanford University EE179 course website: <a class="reference external" href="https://web.stanford.edu/class/ee179/Homework.html.">https://web.stanford.edu/class/ee179/Homework.html.</a>)</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>For the this lab we’ll look at decoding packets from Automatic Dependent Surveillance-Broadcast (ADS-B). This is the system used to track aircraft in real time. Each plane constantly sends out a stream of digital packets. These are on-off keying, and are a great first project for decoding packet radio. There are many interesting aspects of how this system works.</p>
<p>If you want to get right to the lab, and your part, you can skip down to the “Decoding ADSB Packets” section below.</p>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>ADS-B transmitters are currently carried by all planes in the US. Commercial aircraft use these packets to periodically broadcast their tail number, flight, altitude, direction, and speed. Light planes can transmit shorter packets that simply identify them. By 2020 all planes in US airspace were to have to their full information and status, but that is still continuing now. Other countries have sightly later schedules.</p>
<p>In the past planes were tracked with radar. This does a great job of detecting planes, and measuring their range and velocity towards the radar. It does less well for localizing the plane in angle space, due to the beam width, and has no idea which plane it is interrogating. The basic idea of ADSB is that planes have a very good idea of where they are from GPS, and who they are, and where they are going. All the air traffic control system needs to do is ask, and the plane will be able provide all this and more.</p>
<p>The general layout of the system looks like this:</p>
<p><img alt="" src="labs/ADSB_System.png" /></p>
<p>The planes listen to the GPS system to figure out where they are, and then transmit that information to other planes and ground control using short digital packets.</p>
<p>The packets that are sent are called “squitters”, a term which originated in the military with Identification Friend or Foe (IFF) systems. The goal of this lab is to acquire and decode these packets.</p>
<p>Programs like dump1090 on macos and linux (and many more on Windows) use your rtl-sdr to acquire and track the ADSB packets. An example from yesterday afternoon is shown below,</p>
<p><img alt="" src="labs/ADSB_Dump1090_PM.png" /></p>
<p>This is in the afternoon about 3:30. You can clearly see how the planes are lining up for SFO, and lots of small plane traffic around San Carlos. The small planes have only recently started appearing in large numbers. If you click on a plane, it gives you its flight information including it current flight track.</p>
<p>Since ADSB is public, many web sites aggregate the ADSB data from a wide range of sites to provide real time information about where flights are, and the flight paths they have taken. Two are <a class="reference external" href="http://Flightaware.com">Flightaware.com</a> and <a class="reference external" href="http://Flightradar24.com">Flightradar24.com</a>. This is very useful.</p>
<p>An example from Flightaware for a flight a few summers ago is</p>
<p><img alt="" src="labs/Flight_Aware.png" /></p>
<p>These sites actively recruit people with rtl-sdr’s to participate in their network, and even sell branded rtl-sdr’s explicitly for this purpose:</p>
<p><img alt="" src="labs/Flight_Aware_Dongle.png" /></p>
<p>The hardware is free if you are in an area that needs coverage (sorry, the Bay Area is already pretty well saturated!).</p>
<p>The most important fact about ADSB is that it is not encrypted. This makes the location and identity of every plane public information. This is significant. Numerous law enforcement agencies use surveilience planes or helicopters, and these all have tail numbers, and transmit on ADSB. All of these activities are now publicly available. Google FBI and ADSB, or CIA and ADSB for example. You will find lots of interesting things.</p>
<p>Another interesting example is following the location of Vladamir Putin. When he flies, his aircraft transmits on ADSB, and you can track his trajectory. One plane he often uses has a tail number RA-96012. If you type this in to <a class="reference external" href="http://flightradar24.com">flightradar24.com</a>, it will show you where he has flown in the last week. Pay for a subscription, and you can follow his flight for the last couple of years. It is pretty interesting which airspace he flies through, and which airspace he avoids!</p>
<p>Another interesting example is Putin’s doomsday aircraft. This is a telecommunications aircraft that circles above his location wherever he is, to make sure that if buttons need pressing, they will work. There are a couple of these, but one example is here</p>
<p><img alt="" src="labs/Putin_2.png" /></p>
<p>For the U.S., Air Force 1 generally turns off its ADSB transponder, but occasionally does turn it on.</p>
</section>
<section id="decoding-adsb-packets">
<h2>Decoding ADSB Packets<a class="headerlink" href="#decoding-adsb-packets" title="Link to this heading">#</a></h2>
<p>Before starting to acquire signals, it is useful to check to make sure there is something out there! If we run gqrx and look for packets at 1090 MHz, we see something like this:</p>
<p><img alt="" src="labs/ADSB_gqrx.png" /></p>
<p>This should a little like the packets you captured for this week. Packets are very short, so they spread across the spectrum. Each time a packet comes in, the spectrum jumps. There is a lot of traffic! We are going to collect some of this, and decode it.</p>
<p>The ADSB packets are short sequences of pulses, that look like this:</p>
<p><img alt="" src="labs/ADSB_Packet_Waveform.png" /></p>
<p>Each pulse is 1 us long, and consists of two 0.5 us pulses. There is an 8 us preamble that allows you to find the start of the packet. It’s spacing is unique, and can’t turn up in a packet. The packet itself follows, and is either 56 or 112 us long, which decodes to 56 or 112 bits. Bit are encoded as a split phase pulses, where a falling transition is a 1, and a rising transition is a 0.</p>
<p>The split phase pulses are exactly at the Nyquist limit if we sample at 2 MHz, as we have been doing in the previous labs, and that will make resolving the pulses difficult (although that is what is commonly done!). Fortunately the rtl-sdr’s that you are using will sample up to 3.2 MHz, which is fast enough that we can see the pulses clearly.</p>
<p>Capture some data with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">rtl_sdr</span> <span class="o">-</span><span class="n">f</span> <span class="mi">1090000000</span> <span class="o">-</span><span class="n">n</span> <span class="mi">16000000</span> <span class="o">-</span><span class="n">s</span> <span class="mi">3200000</span> <span class="n">adsb_32</span><span class="o">.</span><span class="n">dat</span>

</pre></div>
</div>
<p>This will give you 5 seconds of data. Here is a capture I did</p>
<p><a class="reference internal" href="#adsb_3.2M.dat"><span class="xref myst">adsb_3.2M.dat</span></a></p>
<p>Load them into matlab</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span> <span class="n">da</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">loadFile</span><span class="p">(</span><span class="s1">&#39;adsb_3.2M.dat&#39;</span><span class="p">));</span>

</pre></div>
</div>
<p>There was an earlier file <a class="reference internal" href="#adsb_32.dat"><span class="xref myst">adsb_32.dat</span></a> which is not quite as active. We’ll give you an even better file below, with lots of activity.</p>
<p>We are only concerned with the envelope, so we use the absolute value. The bit boundaries are on 1 us increments, which doesn’t match our 3.2 MHz sampling rate. We’ll upsample to 4 MHz to make make the bit boundaries line up with the samples</p>
<p>This upsamples by a factor of 5, then downsamples by a factor of 4 to leave us at (3.2 MHz) * 5 / 4 = 4 MHz.</p>
<p>If we plot the first 1e6 samples, we see something like this</p>
<p><img alt="" src="labs/ADSB_1e6.png" /></p>
<p>Each of the spikes is a packet. Use your matlab zoom to visualize one of them. One packet is shown here</p>
<p><img alt="" src="labs/ADSB_Raw_Waveform.png" /></p>
<p>You can clearly see the preamble and the data bits. If we’d only sampled at 2 MHz, the result would have been</p>
<p><img alt="" src="labs/ADSB_2MHz_Sampling.png" /></p>
<p>which is much harder to decode!</p>
<p>If we take the 4 MHz sampled data and threshold it we get the ADSB waveform</p>
<p><img alt="" src="labs/ADSB_Detected_Waveform.png" /></p>
<p>Then subsampling by a factor of 2 and shifting to the first non-zero bit, we get the ADSB bit stream for the packet.</p>
<p><img alt="" src="labs/ADSB_Bits.png" /></p>
<p>We decode this as</p>
<p><img alt="" src="labs/ADSB_Decode.png" /></p>
<p>Since the packets are only 56 or 112 bits, a lot of effort has been devoted to compressing as much information into the packets as possible. This is fairly intricate. We’ll restrict our attention to finding packets with the fight numbers of the planes. Each plane sends these out every 2 s.</p>
<p>The bits in the 112 us ADSB packet are allocated as follows,</p>
<p><img alt="" src="labs/ADSB_Bit_Allocation.png" /></p>
<p>The first 5 bits after the preamble identify the type of packet. This will be 17 or 18 for planes communicating to the ground. We are only interested in the DF 17 packets. The next three bits tell something about where the plane is, we’ll skip these.</p>
<p>The unique identifier for the plane is the next 24 bits. If you format these bits as a hexidecimal string, and type that into google, you will find out which specific airframe this is, who owns it, and what they do with it.</p>
<p>After that is the data bits, that we will decode. This looks like</p>
<p><img alt="" src="labs/ADSB_Data_field.png" /></p>
<p>The data field can be decoded for the flight number like this</p>
<p><img alt="" src="labs/ADSB_Data_Field_Decoding.png" /></p>
<p>The identify packets we are looking for have an initial 5 bits (bits 33-37) of [0 0 1 0 0], like the packet above. This is the TC field. Search for this to decide which packets to decode. There are lots of other DF 17 packets that report altitude, direction, and location. Only a few of the DF 17 packets are identify packets. These are sent out every 2 s, while each of the others is sent out every 0.2 s.</p>
<p>After the initial 8 bits of the data packet, the characters for the flight number are sent as six bit integers, where each integer encodes for a character</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#ABCDEFGHIJKLMNOPQRSTUVWXYZ#####_###############0123456789######</span>

</pre></div>
</div>
<p>The # entries are not used. This can be summarized as 1-26 =&gt; A-Z, 48-57=&gt; 0-9, and 32 =&gt; space. In matlab, you can implement the decoder as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">decode_id</span><span class="p">(</span><span class="n">pd</span><span class="p">)</span>

<span class="o">%</span> <span class="n">decoding</span> <span class="n">vector</span>
<span class="n">dcd</span> <span class="o">=</span> <span class="s1">&#39;#ABCDEFGHIJKLMNOPQRSTUVWXYZ#####_###############0123456789######&#39;</span><span class="p">;</span>

<span class="o">%</span> <span class="n">number</span> <span class="n">of</span> <span class="n">packets</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">packet</span> <span class="n">length</span> <span class="n">lp</span>
<span class="p">[</span><span class="n">np</span> <span class="n">lp</span><span class="p">]</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">pd</span><span class="p">);</span>

<span class="o">%</span> <span class="k">for</span> <span class="n">each</span> <span class="n">packet</span>
<span class="k">for</span> <span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">np</span><span class="p">,</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="o">%</span> <span class="n">decode</span> <span class="mi">7</span> <span class="n">characters</span> <span class="mi">6</span> <span class="n">bits</span> <span class="n">at</span> <span class="n">a</span> <span class="n">time</span>
    <span class="k">for</span> <span class="n">kk</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">:(</span><span class="mi">6</span><span class="o">*</span><span class="mi">7</span><span class="p">),</span>
        <span class="o">%</span> <span class="n">compute</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">next</span> <span class="mi">6</span> <span class="n">bits</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pd</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="o">+</span><span class="p">[</span><span class="mi">40</span><span class="p">:</span><span class="mi">45</span><span class="p">])</span><span class="o">.*</span><span class="p">(</span><span class="mf">2.</span><span class="o">^</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">]));</span>
	<span class="o">%</span> <span class="n">look</span> <span class="n">up</span> <span class="n">the</span> <span class="n">value</span> <span class="k">for</span> <span class="n">this</span> <span class="mi">6</span> <span class="n">bits</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">decode</span> <span class="n">table</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="p">[</span><span class="n">cs</span> <span class="n">dcd</span><span class="p">(</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">)];</span>
    <span class="n">end</span>
    <span class="o">%</span> <span class="n">display</span> <span class="n">the</span> <span class="n">result</span>
    <span class="n">disp</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
<span class="n">end</span>


</pre></div>
</div>
<p>where pd is a matlab array of row vectors of 1’s and 0’s for each packet.</p>
<p>There is only one identify packet in the capture given above. To test your decoder, here are a couple of other identify packets to work with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;8da6e45a213b5d3340482042cea1&#39;</span>
<span class="s1">&#39;8da6c8262214a075cf68204fa2ea&#39;</span>
<span class="s1">&#39;8da5861e223b4d754538202b41ee&#39;</span>
<span class="s1">&#39;8fa9ee47213b7cf954c820d0b829&#39;</span>
<span class="s1">&#39;8da03f4825184633c75ce0c25fd9&#39;</span>
<span class="s1">&#39;8da2e62120592131df1d609c4876&#39;</span>
<span class="s1">&#39;8da0a457234cb5f5d39e2071ffa5&#39;</span><span class="p">]</span>

</pre></div>
</div>
<p>These are in hexidecimal. To convert them into an array of bits for the decoder above, use this</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">b</span> <span class="o">=</span> <span class="n">hex2bin</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="n">bta</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">;</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">;</span>
       <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">;</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">;</span>
       <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">;</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">;</span>
       <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">;</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">];</span>

<span class="n">b</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">for</span> <span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">(</span><span class="n">s</span><span class="p">),</span>
    <span class="n">kk</span> <span class="o">=</span> <span class="n">sscanf</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">jj</span><span class="p">),</span><span class="s1">&#39;</span><span class="si">%x</span><span class="s1">&#39;</span><span class="p">);</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="n">bta</span><span class="p">(</span><span class="n">kk</span><span class="o">+</span><span class="mi">1</span><span class="p">,:)];</span>
<span class="n">end</span>
<span class="n">end</span>

</pre></div>
</div>
<p>A couple of flight numbers you should find are N543PD , FDX3153,and SKW5498.</p>
</section>
<section id="lab-report">
<h2>Lab Report<a class="headerlink" href="#lab-report" title="Link to this heading">#</a></h2>
<p>For your lab report, try your processing code on this data set</p>
<p><a class="reference internal" href="#adsb_3.2M_3.dat"><span class="xref myst">adsb_3.2M_3.dat</span></a></p>
<p>This was acquired during a much busier time of the day. There are about 400 packets of various types, with at least 7 identify packets (not bad for 2 s of data!). The optimum threshold varies by packet, so you will get different planes with different thresholds. Try threshold levels of 20, 10 and 5. A better approach would be a packet level specific threshold, but that is beyond this lab.</p>
<p>Decode the 24 bit ICAO identifiers as hex integers. Report how many unique planes to you hear. There will be lots of these packets because it includes all of the commercial planes, as well as light aircraft that don’t have full adsb transmitters. I get 11 unique ICAO numbers with a threshold of 20.</p>
<p>Only some of the packets are the identify packets we are looking for. These have the first five bits after the preamble (bits 1-5) of 17, and a TC field (bits 33-37) of [0 0 1 0 0]. The data packet then encodes the flight number. Decode these using the mapping given above. You can type them into google, and you can see where they are coming from and going to, but that is not required for this lab.</p>
<p>Include your m-files for each of these functions in your report.</p>
</section>
<section id="just-for-fun">
<h2>Just for Fun<a class="headerlink" href="#just-for-fun" title="Link to this heading">#</a></h2>
<section id="real-time-adsb-plane-plotting">
<h3>Real Time ADSB Plane PLotting<a class="headerlink" href="#real-time-adsb-plane-plotting" title="Link to this heading">#</a></h3>
<p>Use your rtl-sdr to acquire ADSB data, decode it, and map it in real time. Thats where the plots above came from. Set your antenna up with an appropriate length, and vertical polarization. For Windows users the most popular program seems to be <a class="reference external" href="https://www.coaa.co.uk/planeplotter.htm">Plane Plotter</a>. This comes as a self extracting .exe file. It has a free 21 day trial period, after which it costs 25 Euros. For the Mac and Linux, the key piece of software is Dump1090. This captures and decodes the data. The actual display is usually handled by other programs (typically a web server and a browser). Some basic installation guidelines for the mac are <a class="reference external" href="http://ee26n.stanford.edu/Assignments/Dump1090.html">here</a>. Raspbian even has dump1090 in its package manager. 1090 MHz doesn’t go through buildings too well, so put your antenna in a window, or go outside. If you can see the planes, you can pick up their signal.</p>
</section>
<section id="dictator-alert">
<h3>Dictator Alert<a class="headerlink" href="#dictator-alert" title="Link to this heading">#</a></h3>
<p>Check out <a class="reference external" href="https://data.dictatoralert.org/dictatorships/">Dictator Alert</a> for a crowd sourced approach to track “authoritarian regimes.”</p>
</section>
<section id="unfiltered-adsb">
<h3>Unfiltered ADSB<a class="headerlink" href="#unfiltered-adsb" title="Link to this heading">#</a></h3>
<p>Most of the flight data aggregators filter out planes that the government would rather not have tracked, such as military, police, and other agencies. However, the packets are broadcast in the clear, and anyone can receive and decode them. One site that aggregates all available data is <a class="reference internal" href="#adsbexchange.com"><span class="xref myst">ADSBExchange</span></a>. Here is what the Bay Area looks like yesterday evening</p>
<p><img alt="" src="labs/ADSBExchange.png" /></p>
<p>There are 64 planes visible. I clicked on an unusually shaped one, and it turned out to be a C17 just landing at Travis Airforce Base. There are also a Contra Costa County helicopter looking for something</p>
<p><img alt="" src="labs/ADSBExchange_CC.png" /></p>
<p>See what you can find!</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./labs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Lab6.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lab 6: A Few Different Digital Signals</p>
      </div>
    </a>
    <a class="right-next"
       href="Lab8.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab 8: Digital Packet Radio – APRS</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#decoding-adsb-packets">Decoding ADSB Packets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-report">Lab Report</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#just-for-fun">Just for Fun</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#real-time-adsb-plane-plotting">Real Time ADSB Plane PLotting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dictator-alert">Dictator Alert</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unfiltered-adsb">Unfiltered ADSB</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By DFEC
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>